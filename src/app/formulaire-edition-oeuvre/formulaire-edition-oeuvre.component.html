<!--titre a dynamiser fonction qu'on ajoute ou edite une oeuvre-->
<h1>Ajout d'une oeuvre (film/serie)</h1>

<!-- toolbar bouton du haut-->
<mat-toolbar >
  <mat-toolbar-row class="boite-outil">
    <button routerLink="/"  type="button" class="btn btn-warning">
      <i class="fa-solid fa-arrow-left"></i>
    </button>
    <button (click)="resetForm()" type="button" class="btn btn-warning">
      réinitialiser
    </button>
    <span></span><!--pour que bouton reinitialiser apparaisse au milieu-->
  </mat-toolbar-row>
</mat-toolbar>
<!-- fin toolbar bouton du haut-->

<!-- bandeau message statut sauvegarde-->
<div *ngIf="isOeuvreSauvee" class="alert alert-success alert-dismissible fade show" role="alert">
  <strong>Success!</strong> Oeuvre sauvegardée
  <button (click)="removeMessage()" type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
<div *ngIf="!isSauvegardeOk" class="alert alert-danger alert-dismissible fade show" role="alert">
  <strong>Erreur</strong> de la sauvegarde
  <p>{{msgErreur}}</p>
  <button (click)="removeMessage()" type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>



<form [formGroup]="oeuvreForm" #formDirective="ngForm" (submit)="onSubmitForm($event,formDirective)" class="my-2">
  <div class="row border border-warning m-3 p-3">
    <div class="col-12 col-md-6"><!--debut 1ere colonne-->
      <!-- Type Oeuvre-->
      <div>
        <mat-form-field   appearance="outline">
          <mat-label>Select Type d'oeuvre</mat-label>
          <mat-select formControlName="typeOeuvre" [(value)]="selectionType">
            <mat-option *ngFor="let type of types" [value]="type.libelle">
              {{type.libelle | titlecase }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Titre -->
      <div>
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Titre</mat-label>
          <input formControlName="titre" matInput>
        </mat-form-field>
      </div>

      <!--genres-->
      <div>
        <mat-form-field>
          <mat-select formControlName="genreIds" placeholder="Genres" name="values" multiple>
            <mat-option *ngFor="let g of genres" [value]="g.id">
              {{g.libelle}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!--statut visionnage-->
      <div>
        <mat-form-field>
          <mat-select formControlName="statutVisionnageId" placeholder="Statut visionnage">
            <mat-option *ngFor="let s of statutVisionnages" [value]="s.id">
              {{s.libelle}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>



      <!-- duree d'un film -->
      <!-- on affiche que s'il s'agit d'un film -->
      <div *ngIf="oeuvreForm.value.typeOeuvre =='film'" >
        <mat-form-field appearance="outline">
          <mat-label>Durée (en minutes)</mat-label>
          <input matInput formControlName="duree" type="number">
        </mat-form-field>
      </div>

      <!-- description -->
      <div>
        <mat-form-field appearance="fill" class="w-100">
          <mat-label>Description</mat-label>
          <textarea matInput formControlName="description" cdkTextareaAutosize ></textarea>
        </mat-form-field>
      </div>
    </div> <!--fin 1ere colonne-->


    <div class="col-12 col-md-6"><!--debut premiere colonne-->
      <!-- Créateur -->
      <div>
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Créateur</mat-label>
          <input formControlName="createurs" matInput>
        </mat-form-field>
      </div>
      <!-- Acteurs -->
      <div>
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Acteurs</mat-label>
          <input formControlName="acteurs" matInput>
        </mat-form-field>
      </div>
      <!-- note de l'oeuvre-->
      <div>
        <mat-form-field>
          <mat-select formControlName="note" placeholder="Note">
            <mat-option *ngFor="let note of notePossibles" [value]="note">
              {{note}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Affiche -->
      <div>
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Url de l'affiche</mat-label>
          <input formControlName="urlAffiche" matInput>
        </mat-form-field>
      </div>

      <div *ngIf="oeuvreForm.value.urlAffiche !=''" >
        <div class="blockImg mb-3">
            <img [src]="oeuvreForm.value.urlAffiche" alt="" class="w-100" >
        </div>
      </div>

      <!-- Video youtube -->
      <div>
        <mat-form-field appearance="outline" class="champ-video-youtube">
          <mat-label>Clé video youtube</mat-label>
          <input formControlName="urlBandeAnnonce" matInput placeholder="Clé Youtube remplacant ????">
          <mat-hint>https://www.youtube.com/watch?v=????</mat-hint>
        </mat-form-field>
      </div>


    </div><!-- Fin 2eme colonne-->
  </div><!--Fin row-->

  <!-- toolbar bouton du bas-->
  <div class="row">
    <mat-toolbar >
      <mat-toolbar-row class="boite-outil">
        <button type="submit" class="btn btn-warning">Sauver</button>

        <!-- en fonction de si on vient de la liste ou de detail, le routage devrait etre dynamique, retour vers la bonne page-->
        <button routerLink="/"  type="button" class="btn btn-warning">
          Annuler
        </button>

        <!-- action a coder-->
        <button type="button" class="btn btn-warning">
          Supprimer
        </button>
      </mat-toolbar-row>
    </mat-toolbar>
  </div>
  <!-- fin toolbar bouton du bas-->
</form>

<pre style="background-color: white;">{{oeuvreASauverJson|json}}</pre>
